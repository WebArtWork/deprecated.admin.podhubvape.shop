import{a as P}from"./chunk-NN7DSGKL.js";import{g as L}from"./chunk-ABGPTASO.js";import"./chunk-2YKZWEXU.js";import{D as g,E as n,Ga as I,H as b,J as c,Ka as x,O as C,P as w,Q as y,Ra as k,T as S,U as j,V as d,Wa as M,Ya as T,_a as a,db as F,l as u,lb as N,m as h,mb as q,n as m,o as f,p,qb as A,t as _,u as v,ua as D}from"./chunk-HR67YQAP.js";var R=(()=>{class i{new(){return{_id:"",name:"",stores:[],code:"",amount:0}}constructor(e,t){this.mongo=e,this.alert=t,this.discounts=[],this._discounts={},this.discounts=e.get("discount",{},(s,o)=>{this._discounts=o})}create(e=this.new(),t=o=>{},s="discount has been created."){e._id?this.save(e):this.mongo.create("discount",e,o=>{t(o),this.alert.show({text:s})})}doc(e){return this._discounts[e]||(this._discounts[e]=this.mongo.fetch("discount",{query:{_id:e}})),this._discounts[e]}update(e,t=o=>{},s="discount has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,t,s)})}save(e,t=o=>{},s="discount has been updated."){this.mongo.update("discount",e,()=>{s&&this.alert.show({text:s,unique:e})})}delete(e,t=o=>{},s="discount has been deleted."){this.mongo.delete("discount",e,()=>{s&&this.alert.show({text:s})})}static{this.\u0275fac=function(t){return new(t||i)(m(T),m(a))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function H(i,K){if(i&1){let e=S();C(0,"wselect",2),j("modelChange",function(s){_(e);let o=d();return v(o.setStore(s))}),w()}if(i&2){let e=d();c("clearable",!0)("items",e.stores)("select",e.store)}}var E=(()=>{class i{get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setDiscounts()}setDiscounts(){this.discounts.splice(0,this.discounts.length);for(let e of this._sd.discounts)e.stores=e.stores||[],this.store?e.stores.includes(this.store)&&this.discounts.push(e):this.discounts.push(e)}constructor(e,t,s,o,U,W,Y,z){this._sd=e,this._translate=t,this._alert=s,this._form=o,this._core=U,this._ss=W,this._store=Y,this._router=z,this.columns=["name","code","amount"],this.form=this._form.getForm("discounts",{formId:"discounts",title:"Discounts",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill discounts title"},{name:"Label",value:"Title"}]},{name:"Number",key:"amount",fields:[{name:"Placeholder",value:"fill discounts amount"},{name:"Label",value:"amount"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill your stores"},{name:"Label",value:"Stores"},{name:"Multiple",value:!0},{name:"Items",value:this.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(r,l)=>{this._sd.create(r,this.setDiscounts.bind(this)),l()}})},update:r=>{this._form.modal(this.form,[],r).then(l=>{this._core.copy(l,r),this._sd.save(r)})},delete:r=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this cservice?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._sd.delete(r)}}]})},buttons:[{icon:"cloud_download",click:r=>{this._form.modalUnique("discount","code",r)}}]},this.discounts=[]}static{this.\u0275fac=function(t){return new(t||i)(n(R),n(F),n(a),n(N),n(k),n(P),n(M),n(I))}}static{this.\u0275cmp=f({type:i,selectors:[["ng-component"]],decls:2,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Discounts",3,"columns","config","rows"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"]],template:function(t,s){t&1&&(b(0,H,1,3,"wselect",0),y(1,"wtable",1)),t&2&&(c("ngIf",s.stores.length),g(),c("columns",s.columns)("config",s.config)("rows",s._sd.discounts))},dependencies:[q,D,A]})}}return i})();var J=[{path:"",component:E}],ne=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=p({type:i})}static{this.\u0275inj=h({imports:[x.forChild(J),L]})}}return i})();export{ne as DiscountsModule};
