import{a as O}from"./chunk-JBVE7GSA.js";import{a as $}from"./chunk-CLYS6LLK.js";import{g as J}from"./chunk-G5ZQNHKW.js";import"./chunk-UXV34W4T.js";import{$a as N,D as v,E as s,H as I,J as p,Ka as D,O as r,P as a,Ra as F,T as g,U as m,V as h,Wa as L,Ya as w,_a as b,ca as d,da as P,db as A,eb as q,gb as y,l as k,lb as G,m as M,mb as B,n as T,o as f,p as E,pb as U,qb as H,t as _,u as C,ua as V}from"./chunk-KNFC6JSA.js";var S=(()=>{class t{new(){return{}}constructor(e,n){this.mongo=e,this.alert=n,this.contents=[],this._contents={},this.contents=e.get("content",{},(i,o)=>{this._contents=o})}create(e=this.new(),n=o=>{},i="content has been created."){e._id?this.save(e):this.mongo.create("content",e,o=>{n(o),this.alert.show({text:i})})}doc(e){return this._contents[e]||(this._contents[e]=this.mongo.fetch("content",{query:{_id:e}})),this._contents[e]}update(e,n=o=>{},i="content has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,n,i)})}save(e,n=o=>{},i="content has been updated."){this.mongo.update("content",e,()=>{i&&this.alert.show({text:i,unique:e})})}delete(e,n=o=>{},i="content has been deleted."){this.mongo.delete("content",e,()=>{i&&this.alert.show({text:i})})}static{this.\u0275fac=function(n){return new(n||t)(T(w),T(b))}}static{this.\u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var W=(()=>{class t{constructor(e){this._ss=e,this.chatGPT="[{name: 'Entity Name'}]",this.entities=""}create(){let e=JSON.parse(this.entities);for(let n of e)n.stores=this.store?[this.store]:[],this._ss.create(n)}static{this.\u0275fac=function(n){return new(n||t)(s(S))}}static{this.\u0275cmp=f({type:t,selectors:[["app-contents-create"]],decls:9,vars:1,consts:[["placeholder","Provide array of Content",3,"wChange"],[3,"click"]],template:function(n,i){n&1&&(r(0,"h1"),d(1,"Create Content"),a(),r(2,"winput",0),m("wChange",function(l){return i.entities=l}),a(),r(3,"wbutton",1),m("click",function(){return i.create(),i.close()}),d(4,"Create"),a(),r(5,"div"),d(6,"Drop next text to chatGPT to inform him what data he should create. After that you can inform him what you need to be created"),a(),r(7,"pre"),d(8),a()),n&2&&(v(8),P(i.chatGPT))},dependencies:[q,y]})}}return t})();function ne(t,u){if(t&1){let e=g();r(0,"wselect",4),m("modelChange",function(i){_(e);let o=h();return C(o.setStore(i))}),a()}if(t&2){let e=h();p("clearable",!0)("items",e.stores)("select",e.store)}}function ie(t,u){if(t&1){let e=g();r(0,"winput",5),m("wChange",function(i){let o=_(e).$implicit,l=h();return o.enabled=i,C(l.update(o))}),a()}if(t&2){let e=u.$implicit;p("value",e.enabled)}}function oe(t,u){if(t&1){let e=g();r(0,"winput",5),m("wChange",function(i){let o=_(e).$implicit,l=h();return o.top=i,C(l.update(o))}),a()}if(t&2){let e=u.$implicit;p("value",e.top)}}var Y=(()=>{class t{setContents(){this.contents.splice(0,this.contents.length);for(let e of this._cs.contents)e.stores=e.stores||[],this.store?e.stores.includes(this.store)&&this.contents.push(e):this.contents.push(e)}update(e){this._cs.update(e)}get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setContents()}constructor(e,n,i,o,l,z,K,Q,X,Z){this._cs=e,this._translate=n,this._alert=i,this._form=o,this._core=l,this._modal=z,this._mongo=K,this._us=Q,this._store=X,this._ss=Z,this.columns=["enabled","top","name","description"],this.form=this._form.getForm("contents",{formId:"contents",title:"Contents",components:[{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Header picture"}]},{name:"Text",key:"url",focused:!0,fields:[{name:"Placeholder",value:"fill url"},{name:"Label",value:"Url"}]},{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill description"},{name:"Label",value:"Description"}]},{name:"Text",key:"content",fields:[{name:"Placeholder",value:"fill content"},{name:"Label",value:"Content"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill product tag"},{name:"Label",value:"Tag"},{name:"Multiple",value:!0},{name:"Items",value:this._ss.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(c,x)=>{this.store&&(c.stores=[this.store]),this._cs.create(c,this.setContents.bind(this)),x()}},this.store?{stores:[this.store]}:{})},update:c=>{this._form.modal(this.form,[],c).then(x=>{this._core.copy(x,c),this._cs.save(c)})},delete:c=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this cservice?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._cs.delete(c)}}]})},headerButtons:[this._us.role("admin")||this._us.role("agent")?{icon:"add_circle",click:()=>{this._modal.show({component:W,store:this.store})}}:null]},this.contents=[],this._store.get("store",this.setStore.bind(this)),this._mongo.on("content",this.setContents.bind(this))}static{this.\u0275fac=function(n){return new(n||t)(s(S),s(A),s(b),s(G),s(F),s(N),s(w),s($),s(L),s(O))}}static{this.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:4,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Contents",3,"columns","config","rows"],["cell","enabled"],["cell","top"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"],["type","checkbox",3,"wChange","value"]],template:function(n,i){n&1&&(I(0,ne,1,3,"wselect",0),r(1,"wtable",1),I(2,ie,1,1,"ng-template",2)(3,oe,1,1,"ng-template",3),a()),n&2&&(p("ngIf",i.stores.length),v(),p("columns",i.columns)("config",i.config)("rows",i.contents))},dependencies:[B,V,y,H,U]})}}return t})();var se=[{path:"",component:Y}],Se=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=E({type:t})}static{this.\u0275inj=M({imports:[D.forChild(se),J]})}}return t})();export{Se as ContentsModule};
