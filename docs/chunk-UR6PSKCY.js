import{a as R}from"./chunk-7NC53JNR.js";import{g as V}from"./chunk-QBB5AXD6.js";import"./chunk-TNDQIX7V.js";import{C as w,D as c,Ga as D,H as C,J as l,Ka as T,O as y,P as S,Q as j,Ra as M,T as I,U as x,V as h,Wa as F,Ya as N,_a as m,db as q,l as f,lb as A,m as p,mb as L,n as u,o as v,p as _,qb as P,t as g,u as b,ua as k}from"./chunk-AEKSWFXE.js";var U=(()=>{let t=class t{new(){return{_id:"",name:"",stores:[],code:"",amount:0}}constructor(e,i){this.mongo=e,this.alert=i,this.discounts=[],this._discounts={},this.discounts=e.get("discount",{},(s,r)=>{this._discounts=r})}create(e=this.new(),i=r=>{},s="discount has been created."){e._id?this.save(e):this.mongo.create("discount",e,r=>{i(r),this.alert.show({text:s})})}doc(e){return this._discounts[e]||(this._discounts[e]=this.mongo.fetch("discount",{query:{_id:e}})),this._discounts[e]}update(e,i=r=>{},s="discount has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,i,s)})}save(e,i=r=>{},s="discount has been updated."){this.mongo.update("discount",e,()=>{s&&this.alert.show({text:s,unique:e})})}delete(e,i=r=>{},s="discount has been deleted."){this.mongo.delete("discount",e,()=>{s&&this.alert.show({text:s})})}};t.\u0275fac=function(i){return new(i||t)(u(N),u(m))},t.\u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();function K(o,t){if(o&1){let a=I();y(0,"wselect",2),x("modelChange",function(i){g(a);let s=h();return b(s.setStore(i))}),S()}if(o&2){let a=h();l("clearable",!0)("items",a.stores)("select",a.store)}}var W=(()=>{let t=class t{get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setDiscounts()}setDiscounts(){this.discounts.splice(0,this.discounts.length);for(let e of this._sd.discounts)e.stores=e.stores||[],this.store?e.stores.includes(this.store)&&this.discounts.push(e):this.discounts.push(e)}constructor(e,i,s,r,Y,z,B,G){this._sd=e,this._translate=i,this._alert=s,this._form=r,this._core=Y,this._ss=z,this._store=B,this._router=G,this.columns=["name","code","amount"],this.form=this._form.getForm("discounts",{formId:"discounts",title:"Discounts",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill discounts title"},{name:"Label",value:"Title"}]},{name:"Number",key:"amount",fields:[{name:"Placeholder",value:"fill discounts amount"},{name:"Label",value:"amount"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill your stores"},{name:"Label",value:"Stores"},{name:"Multiple",value:!0},{name:"Items",value:this.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(n,d)=>{this._sd.create(n,this.setDiscounts.bind(this)),d()}})},update:n=>{this._form.modal(this.form,[],n).then(d=>{this._core.copy(d,n),this._sd.save(n)})},delete:n=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this cservice?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._sd.delete(n)}}]})},buttons:[{icon:"cloud_download",click:n=>{this._form.modalUnique("discount","code",n)}}]},this.discounts=[]}};t.\u0275fac=function(i){return new(i||t)(c(U),c(q),c(m),c(A),c(M),c(R),c(F),c(D))},t.\u0275cmp=v({type:t,selectors:[["ng-component"]],decls:2,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Discounts",3,"columns","config","rows"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"]],template:function(i,s){i&1&&(C(0,K,1,3,"wselect",0),j(1,"wtable",1)),i&2&&(l("ngIf",s.stores.length),w(),l("columns",s.columns)("config",s.config)("rows",s._sd.discounts))},dependencies:[L,k,P]});let o=t;return o})();var O=[{path:"",component:W}],ce=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=_({type:t}),t.\u0275inj=p({imports:[T.forChild(O),V]});let o=t;return o})();export{ce as DiscountsModule};
