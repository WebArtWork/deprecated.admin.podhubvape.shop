import{a as v}from"./chunk-LOBGJIEH.js";import{a as J}from"./chunk-NN7DSGKL.js";import{a as L}from"./chunk-U7JCZEQ7.js";import{g as H}from"./chunk-ABGPTASO.js";import"./chunk-2YKZWEXU.js";import{$a as A,D as f,E as o,Ea as M,Ga as P,H as T,J as p,Ka as D,O as r,P as a,Ra as E,T as S,U as m,V as g,Wa as F,Ya as N,_a as V,ca as d,da as j,db as U,eb as B,gb as _,lb as G,m as I,mb as R,nb as q,o as u,p as x,pb as O,qb as $,t as C,u as w,ua as k}from"./chunk-HR67YQAP.js";var z=(()=>{class i{constructor(e){this._ts=e,this.chatGPT=`Here is a schema for a MongoDB collection:
	mongoose.Schema({
		name: String,
		description: String,
	})
	Please review this schema. I will provide you with specific details about the documents I need you to generate in a follow-up message. For now, do not create or suggest any documents; just acknowledge the schema and wait for my next instructions.`,this.entities=""}create(){let e=JSON.parse(this.entities),t=e.length;for(let s of e)this.store&&(s.stores=[this.store]),this.parent&&(s.parent=[this.parent]),this._ts.create(s,()=>{--t===0&&this.setTags()})}static{this.\u0275fac=function(t){return new(t||i)(o(v))}}static{this.\u0275cmp=u({type:i,selectors:[["app-tags-create"]],decls:9,vars:1,consts:[["placeholder","Provide array of Tags",3,"wChange"],[3,"click"]],template:function(t,s){t&1&&(r(0,"h1"),d(1,"Create Tags"),a(),r(2,"winput",0),m("wChange",function(h){return s.entities=h}),a(),r(3,"wbutton",1),m("click",function(){return s.create(),s.close()}),d(4,"Create"),a(),r(5,"div"),d(6,"Drop next text to chatGPT to inform him what data he should create. After that you can inform him what you need to be created"),a(),r(7,"pre"),d(8),a()),t&2&&(f(8),j(s.chatGPT))},dependencies:[B,_]})}}return i})();function ne(i,y){if(i&1){let e=S();r(0,"wselect",3),m("modelChange",function(s){C(e);let l=g();return w(l.setStore(s))}),a()}if(i&2){let e=g();p("clearable",!0)("items",e.stores)("select",e.store)}}function re(i,y){if(i&1){let e=S();r(0,"winput",4),m("wChange",function(s){let l=C(e).$implicit,h=g();return l.enabled=s,w(h.update(l))}),a()}if(i&2){let e=y.$implicit;p("value",e.enabled)}}var b=(()=>{class i{childrenUrl(e){let t=this._router.url.split("/");return this.parent&&t.pop(),t.push(e._id),t.join("/")}sort(){for(let e=0;e<this.tags.length;e++)this.tags[e].order!==e&&(this.tags[e].order=e,this._ts.save(this.tags[e],()=>{},""))}setTags(){this.tags.splice(0,this.tags.length);for(let e of this._ts.tags)e.stores=e.stores||[],!this.store&&!this.parent?e.parent||this.tags.push(e):this.store&&this.parent?e.parent===this.parent&&e.stores.includes(this.store)&&this.tags.push(e):this.parent?e.parent===this.parent&&this.tags.push(e):e.stores.includes(this.store)&&!e.parent&&this.tags.push(e)}update(e){this._ts.update(e)}get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setTags()}constructor(e,t,s,l,h,K,Q,W,X,Z,ee,te){this._translate=e,this.route=t,this._alert=s,this._modal=l,this._mongo=h,this._store=K,this._form=Q,this._core=W,this._ss=X,this._us=Z,this._ts=ee,this._router=te,this.parent="",this.columns=["enabled","name","url"],this.form=this._form.getForm("tag",{components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill your name"},{name:"Label",value:"Name"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill your description"},{name:"Label",value:"Description"}]},{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Image"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill your stores"},{name:"Label",value:"Stores"},{name:"Multiple",value:!0},{name:"Items",value:this.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(n,c)=>{this.parent&&(n.parent=this.parent),this._ts.create(n,()=>{this.setTags(),this.sort()}),c()}},this.store?{stores:[this.store]}:{})},update:n=>{this._form.modal(this.form,[],n).then(c=>{this._core.copy(c,n),this._ts.save(n)})},delete:n=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this tag?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._ts.delete(n,this.setTags.bind(this))}}]})},buttons:[{icon:"label_important",hrefFunc:this.childrenUrl.bind(this)},{icon:"arrow_upward",click:n=>{let c=this.tags.findIndex(ie=>ie._id===n._id);[this.tags[c],this.tags[c-1]]=[this.tags[c-1],this.tags[c]],this.sort()}},{icon:"cloud_download",click:n=>{this._form.modalUnique("tag","url",n)}}],headerButtons:[this._us.role("admin")||this._us.role("agent")?{icon:"add_circle",click:()=>{this._modal.show({setTags:this.setTags.bind(this),component:z,parent:this.parent,store:this.store})}}:null]},this.tags=[],this._store.get("store",this.setStore.bind(this)),this._mongo.on("tag",this.setTags.bind(this))}ngOnInit(){this.route.params.subscribe(e=>{e.parent&&(this.parent=e.parent,this.setTags())})}static{this.\u0275fac=function(t){return new(t||i)(o(U),o(M),o(V),o(A),o(N),o(F),o(G),o(E),o(J),o(L),o(v),o(P))}}static{this.\u0275cmp=u({type:i,selectors:[["ng-component"]],decls:3,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Product Tags",3,"columns","config","rows"],["cell","enabled"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"],["type","checkbox",3,"wChange","value"]],template:function(t,s){t&1&&(T(0,ne,1,3,"wselect",0),r(1,"wtable",1),T(2,re,1,1,"ng-template",2),a()),t&2&&(p("ngIf",s.stores.length),f(),p("columns",s.columns)("config",s.config)("rows",s.tags))},dependencies:[R,k,_,$,O]})}}return i})();var ae=[{path:"",component:b},{path:":parent",component:b}],ke=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=x({type:i})}static{this.\u0275inj=I({imports:[D.forChild(ae),q,H]})}}return i})();export{ke as TagsModule};
