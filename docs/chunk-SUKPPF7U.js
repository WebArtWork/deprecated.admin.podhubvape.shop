import{a as Mt}from"./chunk-LOBGJIEH.js";import{a as At}from"./chunk-NN7DSGKL.js";import{a as _e}from"./chunk-U7JCZEQ7.js";import{g as xt}from"./chunk-ABGPTASO.js";import"./chunk-2YKZWEXU.js";import{B as ft,D as b,E as p,G as dt,H as q,J as S,Ka as _t,La as ne,M as mt,N as gt,O as C,P as w,Q as pe,Ra as ye,T as Ce,U as L,V as M,Xa as B,Ya as Q,Z as pt,_a as D,ca as y,d,da as z,db as Ie,e as Yn,ea as te,eb as Ee,f as ct,gb as Se,jb as It,kb as Et,l as G,lb as St,m as fe,mb as vt,n as x,na as Ct,o as A,p as de,pb as bt,q as ut,qb as Tt,s as ht,t as me,u as ge,ua as we,va as wt,xa as yt}from"./chunk-HR67YQAP.js";var Pt=d((ci,Lt)=>{"use strict";Lt.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var k=d(H=>{"use strict";var ke,Zn=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];H.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};H.getSymbolTotalCodewords=function(t){return Zn[t]};H.getBCHDigit=function(n){let t=0;for(;n!==0;)t++,n>>>=1;return t};H.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');ke=t};H.isKanjiModeEnabled=function(){return typeof ke<"u"};H.toSJIS=function(t){return ke(t)}});var ve=d(T=>{"use strict";T.L={bit:1};T.M={bit:0};T.Q={bit:3};T.H={bit:2};function Xn(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return T.L;case"m":case"medium":return T.M;case"q":case"quartile":return T.Q;case"h":case"high":return T.H;default:throw new Error("Unknown EC Level: "+n)}}T.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4};T.from=function(t,e){if(T.isValid(t))return t;try{return Xn(t)}catch{return e}}});var Ft=d((fi,Dt)=>{"use strict";function qt(){this.buffer=[],this.length=0}qt.prototype={get:function(n){let t=Math.floor(n/8);return(this.buffer[t]>>>7-n%8&1)===1},put:function(n,t){for(let e=0;e<t;e++)this.putBit((n>>>t-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),n&&(this.buffer[t]|=128>>>this.length%8),this.length++}};Dt.exports=qt});var Ut=d((di,kt)=>{"use strict";function ie(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}ie.prototype.set=function(n,t,e,r){let i=n*this.size+t;this.data[i]=e,r&&(this.reservedBit[i]=!0)};ie.prototype.get=function(n,t){return this.data[n*this.size+t]};ie.prototype.xor=function(n,t,e){this.data[n*this.size+t]^=e};ie.prototype.isReserved=function(n,t){return this.reservedBit[n*this.size+t]};kt.exports=ie});var jt=d(be=>{"use strict";var er=k().getSymbolSize;be.getRowColCoords=function(t){if(t===1)return[];let e=Math.floor(t/7)+2,r=er(t),i=r===145?26:Math.ceil((r-13)/(2*e-2))*2,o=[r-7];for(let s=1;s<e-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()};be.getPositions=function(t){let e=[],r=be.getRowColCoords(t),i=r.length;for(let o=0;o<i;o++)for(let s=0;s<i;s++)o===0&&s===0||o===0&&s===i-1||o===i-1&&s===0||e.push([r[o],r[s]]);return e}});var Ht=d(zt=>{"use strict";var tr=k().getSymbolSize,Vt=7;zt.getPositions=function(t){let e=tr(t);return[[0,0],[e-Vt,0],[0,e-Vt]]}});var Ot=d(g=>{"use strict";g.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var O={N1:3,N2:3,N3:40,N4:10};g.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7};g.from=function(t){return g.isValid(t)?parseInt(t,10):void 0};g.getPenaltyN1=function(t){let e=t.size,r=0,i=0,o=0,s=null,a=null;for(let l=0;l<e;l++){i=o=0,s=a=null;for(let u=0;u<e;u++){let c=t.get(l,u);c===s?i++:(i>=5&&(r+=O.N1+(i-5)),s=c,i=1),c=t.get(u,l),c===a?o++:(o>=5&&(r+=O.N1+(o-5)),a=c,o=1)}i>=5&&(r+=O.N1+(i-5)),o>=5&&(r+=O.N1+(o-5))}return r};g.getPenaltyN2=function(t){let e=t.size,r=0;for(let i=0;i<e-1;i++)for(let o=0;o<e-1;o++){let s=t.get(i,o)+t.get(i,o+1)+t.get(i+1,o)+t.get(i+1,o+1);(s===4||s===0)&&r++}return r*O.N2};g.getPenaltyN3=function(t){let e=t.size,r=0,i=0,o=0;for(let s=0;s<e;s++){i=o=0;for(let a=0;a<e;a++)i=i<<1&2047|t.get(s,a),a>=10&&(i===1488||i===93)&&r++,o=o<<1&2047|t.get(a,s),a>=10&&(o===1488||o===93)&&r++}return r*O.N3};g.getPenaltyN4=function(t){let e=0,r=t.data.length;for(let o=0;o<r;o++)e+=t.data[o];return Math.abs(Math.ceil(e*100/r/5)-10)*O.N4};function nr(n,t,e){switch(n){case g.Patterns.PATTERN000:return(t+e)%2===0;case g.Patterns.PATTERN001:return t%2===0;case g.Patterns.PATTERN010:return e%3===0;case g.Patterns.PATTERN011:return(t+e)%3===0;case g.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(e/3))%2===0;case g.Patterns.PATTERN101:return t*e%2+t*e%3===0;case g.Patterns.PATTERN110:return(t*e%2+t*e%3)%2===0;case g.Patterns.PATTERN111:return(t*e%3+(t+e)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}g.applyMask=function(t,e){let r=e.size;for(let i=0;i<r;i++)for(let o=0;o<r;o++)e.isReserved(o,i)||e.xor(o,i,nr(t,o,i))};g.getBestMask=function(t,e){let r=Object.keys(g.Patterns).length,i=0,o=1/0;for(let s=0;s<r;s++){e(s),g.applyMask(s,t);let a=g.getPenaltyN1(t)+g.getPenaltyN2(t)+g.getPenaltyN3(t)+g.getPenaltyN4(t);g.applyMask(s,t),a<o&&(o=a,i=s)}return i}});var je=d(Ue=>{"use strict";var U=ve(),Te=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xe=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ue.getBlocksCount=function(t,e){switch(e){case U.L:return Te[(t-1)*4+0];case U.M:return Te[(t-1)*4+1];case U.Q:return Te[(t-1)*4+2];case U.H:return Te[(t-1)*4+3];default:return}};Ue.getTotalCodewordsCount=function(t,e){switch(e){case U.L:return xe[(t-1)*4+0];case U.M:return xe[(t-1)*4+1];case U.Q:return xe[(t-1)*4+2];case U.H:return xe[(t-1)*4+3];default:return}}});var Jt=d(Me=>{"use strict";var oe=new Uint8Array(512),Ae=new Uint8Array(256);(function(){let t=1;for(let e=0;e<255;e++)oe[e]=t,Ae[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)oe[e]=oe[e-255]})();Me.log=function(t){if(t<1)throw new Error("log("+t+")");return Ae[t]};Me.exp=function(t){return oe[t]};Me.mul=function(t,e){return t===0||e===0?0:oe[Ae[t]+Ae[e]]}});var Kt=d(se=>{"use strict";var Ve=Jt();se.mul=function(t,e){let r=new Uint8Array(t.length+e.length-1);for(let i=0;i<t.length;i++)for(let o=0;o<e.length;o++)r[i+o]^=Ve.mul(t[i],e[o]);return r};se.mod=function(t,e){let r=new Uint8Array(t);for(;r.length-e.length>=0;){let i=r[0];for(let s=0;s<e.length;s++)r[s]^=Ve.mul(e[s],i);let o=0;for(;o<r.length&&r[o]===0;)o++;r=r.slice(o)}return r};se.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let r=0;r<t;r++)e=se.mul(e,new Uint8Array([1,Ve.exp(r)]));return e}});var Qt=d((_i,Gt)=>{"use strict";var Yt=Kt();function ze(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}ze.prototype.initialize=function(t){this.degree=t,this.genPoly=Yt.generateECPolynomial(this.degree)};ze.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");let e=new Uint8Array(t.length+this.degree);e.set(t);let r=Yt.mod(e,this.genPoly),i=this.degree-r.length;if(i>0){let o=new Uint8Array(this.degree);return o.set(r,i),o}return r};Gt.exports=ze});var He=d(Wt=>{"use strict";Wt.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}});var Oe=d(P=>{"use strict";var $t="[0-9]+",rr="[A-Z $%*+\\-./:]+",ae="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ae=ae.replace(/u/g,"\\u");var ir="(?:(?![A-Z0-9 $%*+\\-./:]|"+ae+`)(?:.|[\r
]))+`;P.KANJI=new RegExp(ae,"g");P.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");P.BYTE=new RegExp(ir,"g");P.NUMERIC=new RegExp($t,"g");P.ALPHANUMERIC=new RegExp(rr,"g");var or=new RegExp("^"+ae+"$"),sr=new RegExp("^"+$t+"$"),ar=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");P.testKanji=function(t){return or.test(t)};P.testNumeric=function(t){return sr.test(t)};P.testAlphanumeric=function(t){return ar.test(t)}});var j=d(I=>{"use strict";var lr=He(),Je=Oe();I.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};I.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};I.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};I.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};I.MIXED={bit:-1};I.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!lr.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]};I.getBestModeForData=function(t){return Je.testNumeric(t)?I.NUMERIC:Je.testAlphanumeric(t)?I.ALPHANUMERIC:Je.testKanji(t)?I.KANJI:I.BYTE};I.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")};I.isValid=function(t){return t&&t.bit&&t.ccBits};function cr(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return I.NUMERIC;case"alphanumeric":return I.ALPHANUMERIC;case"kanji":return I.KANJI;case"byte":return I.BYTE;default:throw new Error("Unknown mode: "+n)}}I.from=function(t,e){if(I.isValid(t))return t;try{return cr(t)}catch{return e}}});var nn=d(J=>{"use strict";var Be=k(),ur=je(),Zt=ve(),V=j(),Ke=He(),en=7973,Xt=Be.getBCHDigit(en);function hr(n,t,e){for(let r=1;r<=40;r++)if(t<=J.getCapacity(r,e,n))return r}function tn(n,t){return V.getCharCountIndicator(n,t)+4}function fr(n,t){let e=0;return n.forEach(function(r){let i=tn(r.mode,t);e+=i+r.getBitsLength()}),e}function dr(n,t){for(let e=1;e<=40;e++)if(fr(n,e)<=J.getCapacity(e,t,V.MIXED))return e}J.from=function(t,e){return Ke.isValid(t)?parseInt(t,10):e};J.getCapacity=function(t,e,r){if(!Ke.isValid(t))throw new Error("Invalid QR Code version");typeof r>"u"&&(r=V.BYTE);let i=Be.getSymbolTotalCodewords(t),o=ur.getTotalCodewordsCount(t,e),s=(i-o)*8;if(r===V.MIXED)return s;let a=s-tn(r,t);switch(r){case V.NUMERIC:return Math.floor(a/10*3);case V.ALPHANUMERIC:return Math.floor(a/11*2);case V.KANJI:return Math.floor(a/13);case V.BYTE:default:return Math.floor(a/8)}};J.getBestVersionForData=function(t,e){let r,i=Zt.from(e,Zt.M);if(Array.isArray(t)){if(t.length>1)return dr(t,i);if(t.length===0)return 1;r=t[0]}else r=t;return hr(r.mode,r.getLength(),i)};J.getEncodedBits=function(t){if(!Ke.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;Be.getBCHDigit(e)-Xt>=0;)e^=en<<Be.getBCHDigit(e)-Xt;return t<<12|e}});var an=d(sn=>{"use strict";var Ye=k(),on=1335,mr=21522,rn=Ye.getBCHDigit(on);sn.getEncodedBits=function(t,e){let r=t.bit<<3|e,i=r<<10;for(;Ye.getBCHDigit(i)-rn>=0;)i^=on<<Ye.getBCHDigit(i)-rn;return(r<<10|i)^mr}});var cn=d((Ti,ln)=>{"use strict";var gr=j();function W(n){this.mode=gr.NUMERIC,this.data=n.toString()}W.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};W.prototype.getLength=function(){return this.data.length};W.prototype.getBitsLength=function(){return W.getBitsLength(this.data.length)};W.prototype.write=function(t){let e,r,i;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),i=parseInt(r,10),t.put(i,10);let o=this.data.length-e;o>0&&(r=this.data.substr(e),i=parseInt(r,10),t.put(i,o*3+1))};ln.exports=W});var hn=d((xi,un)=>{"use strict";var pr=j(),Ge=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function $(n){this.mode=pr.ALPHANUMERIC,this.data=n}$.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};$.prototype.getLength=function(){return this.data.length};$.prototype.getBitsLength=function(){return $.getBitsLength(this.data.length)};$.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let r=Ge.indexOf(this.data[e])*45;r+=Ge.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(Ge.indexOf(this.data[e]),6)};un.exports=$});var dn=d((Ai,fn)=>{"use strict";fn.exports=function(t){for(var e=[],r=t.length,i=0;i<r;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319&&r>i+1){var s=t.charCodeAt(i+1);s>=56320&&s<=57343&&(o=(o-55296)*1024+s-56320+65536,i+=1)}if(o<128){e.push(o);continue}if(o<2048){e.push(o>>6|192),e.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){e.push(o>>12|224),e.push(o>>6&63|128),e.push(o&63|128);continue}if(o>=65536&&o<=1114111){e.push(o>>18|240),e.push(o>>12&63|128),e.push(o>>6&63|128),e.push(o&63|128);continue}e.push(239,191,189)}return new Uint8Array(e).buffer}});var gn=d((Mi,mn)=>{"use strict";var Cr=dn(),wr=j();function Z(n){this.mode=wr.BYTE,typeof n=="string"&&(n=Cr(n)),this.data=new Uint8Array(n)}Z.getBitsLength=function(t){return t*8};Z.prototype.getLength=function(){return this.data.length};Z.prototype.getBitsLength=function(){return Z.getBitsLength(this.data.length)};Z.prototype.write=function(n){for(let t=0,e=this.data.length;t<e;t++)n.put(this.data[t],8)};mn.exports=Z});var Cn=d((Bi,pn)=>{"use strict";var yr=j(),_r=k();function X(n){this.mode=yr.KANJI,this.data=n}X.getBitsLength=function(t){return t*13};X.prototype.getLength=function(){return this.data.length};X.prototype.getBitsLength=function(){return X.getBitsLength(this.data.length)};X.prototype.write=function(n){let t;for(t=0;t<this.data.length;t++){let e=_r.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),n.put(e,13)}};pn.exports=X});var wn=d((Ni,Qe)=>{"use strict";var le={single_source_shortest_paths:function(n,t,e){var r={},i={};i[t]=0;var o=le.PriorityQueue.make();o.push(t,0);for(var s,a,l,u,c,_,m,v,h;!o.empty();){s=o.pop(),a=s.value,u=s.cost,c=n[a]||{};for(l in c)c.hasOwnProperty(l)&&(_=c[l],m=u+_,v=i[l],h=typeof i[l]>"u",(h||v>m)&&(i[l]=m,o.push(l,m),r[l]=a))}if(typeof e<"u"&&typeof i[e]>"u"){var E=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(E)}return r},extract_shortest_path_from_predecessor_list:function(n,t){for(var e=[],r=t,i;r;)e.push(r),i=n[r],r=n[r];return e.reverse(),e},find_path:function(n,t,e){var r=le.single_source_shortest_paths(n,t,e);return le.extract_shortest_path_from_predecessor_list(r,e)},PriorityQueue:{make:function(n){var t=le.PriorityQueue,e={},r;n=n||{};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e.queue=[],e.sorter=n.sorter||t.default_sorter,e},default_sorter:function(n,t){return n.cost-t.cost},push:function(n,t){var e={value:n,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof Qe<"u"&&(Qe.exports=le)});var Tn=d(ee=>{"use strict";var f=j(),In=cn(),En=hn(),Sn=gn(),vn=Cn(),ce=Oe(),Ne=k(),Ir=wn();function yn(n){return unescape(encodeURIComponent(n)).length}function ue(n,t,e){let r=[],i;for(;(i=n.exec(e))!==null;)r.push({data:i[0],index:i.index,mode:t,length:i[0].length});return r}function bn(n){let t=ue(ce.NUMERIC,f.NUMERIC,n),e=ue(ce.ALPHANUMERIC,f.ALPHANUMERIC,n),r,i;return Ne.isKanjiModeEnabled()?(r=ue(ce.BYTE,f.BYTE,n),i=ue(ce.KANJI,f.KANJI,n)):(r=ue(ce.BYTE_KANJI,f.BYTE,n),i=[]),t.concat(e,r,i).sort(function(s,a){return s.index-a.index}).map(function(s){return{data:s.data,mode:s.mode,length:s.length}})}function We(n,t){switch(t){case f.NUMERIC:return In.getBitsLength(n);case f.ALPHANUMERIC:return En.getBitsLength(n);case f.KANJI:return vn.getBitsLength(n);case f.BYTE:return Sn.getBitsLength(n)}}function Er(n){return n.reduce(function(t,e){let r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)},[])}function Sr(n){let t=[];for(let e=0;e<n.length;e++){let r=n[e];switch(r.mode){case f.NUMERIC:t.push([r,{data:r.data,mode:f.ALPHANUMERIC,length:r.length},{data:r.data,mode:f.BYTE,length:r.length}]);break;case f.ALPHANUMERIC:t.push([r,{data:r.data,mode:f.BYTE,length:r.length}]);break;case f.KANJI:t.push([r,{data:r.data,mode:f.BYTE,length:yn(r.data)}]);break;case f.BYTE:t.push([{data:r.data,mode:f.BYTE,length:yn(r.data)}])}}return t}function vr(n,t){let e={},r={start:{}},i=["start"];for(let o=0;o<n.length;o++){let s=n[o],a=[];for(let l=0;l<s.length;l++){let u=s[l],c=""+o+l;a.push(c),e[c]={node:u,lastCount:0},r[c]={};for(let _=0;_<i.length;_++){let m=i[_];e[m]&&e[m].node.mode===u.mode?(r[m][c]=We(e[m].lastCount+u.length,u.mode)-We(e[m].lastCount,u.mode),e[m].lastCount+=u.length):(e[m]&&(e[m].lastCount=u.length),r[m][c]=We(u.length,u.mode)+4+f.getCharCountIndicator(u.mode,t))}}i=a}for(let o=0;o<i.length;o++)r[i[o]].end=0;return{map:r,table:e}}function _n(n,t){let e,r=f.getBestModeForData(n);if(e=f.from(t,r),e!==f.BYTE&&e.bit<r.bit)throw new Error('"'+n+'" cannot be encoded with mode '+f.toString(e)+`.
 Suggested mode is: `+f.toString(r));switch(e===f.KANJI&&!Ne.isKanjiModeEnabled()&&(e=f.BYTE),e){case f.NUMERIC:return new In(n);case f.ALPHANUMERIC:return new En(n);case f.KANJI:return new vn(n);case f.BYTE:return new Sn(n)}}ee.fromArray=function(t){return t.reduce(function(e,r){return typeof r=="string"?e.push(_n(r,null)):r.data&&e.push(_n(r.data,r.mode)),e},[])};ee.fromString=function(t,e){let r=bn(t,Ne.isKanjiModeEnabled()),i=Sr(r),o=vr(i,e),s=Ir.find_path(o.map,"start","end"),a=[];for(let l=1;l<s.length-1;l++)a.push(o.table[s[l]].node);return ee.fromArray(Er(a))};ee.rawSplit=function(t){return ee.fromArray(bn(t,Ne.isKanjiModeEnabled()))}});var An=d(xn=>{"use strict";var Le=k(),$e=ve(),br=Ft(),Tr=Ut(),xr=jt(),Ar=Ht(),et=Ot(),tt=je(),Mr=Qt(),Re=nn(),Br=an(),Nr=j(),Ze=Tn();function Rr(n,t){let e=n.size,r=Ar.getPositions(t);for(let i=0;i<r.length;i++){let o=r[i][0],s=r[i][1];for(let a=-1;a<=7;a++)if(!(o+a<=-1||e<=o+a))for(let l=-1;l<=7;l++)s+l<=-1||e<=s+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?n.set(o+a,s+l,!0,!0):n.set(o+a,s+l,!1,!0))}}function Lr(n){let t=n.size;for(let e=8;e<t-8;e++){let r=e%2===0;n.set(e,6,r,!0),n.set(6,e,r,!0)}}function Pr(n,t){let e=xr.getPositions(t);for(let r=0;r<e.length;r++){let i=e[r][0],o=e[r][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?n.set(i+s,o+a,!0,!0):n.set(i+s,o+a,!1,!0)}}function qr(n,t){let e=n.size,r=Re.getEncodedBits(t),i,o,s;for(let a=0;a<18;a++)i=Math.floor(a/3),o=a%3+e-8-3,s=(r>>a&1)===1,n.set(i,o,s,!0),n.set(o,i,s,!0)}function Xe(n,t,e){let r=n.size,i=Br.getEncodedBits(t,e),o,s;for(o=0;o<15;o++)s=(i>>o&1)===1,o<6?n.set(o,8,s,!0):o<8?n.set(o+1,8,s,!0):n.set(r-15+o,8,s,!0),o<8?n.set(8,r-o-1,s,!0):o<9?n.set(8,15-o-1+1,s,!0):n.set(8,15-o-1,s,!0);n.set(r-8,8,1,!0)}function Dr(n,t){let e=n.size,r=-1,i=e-1,o=7,s=0;for(let a=e-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!n.isReserved(i,a-l)){let u=!1;s<t.length&&(u=(t[s]>>>o&1)===1),n.set(i,a-l,u),o--,o===-1&&(s++,o=7)}if(i+=r,i<0||e<=i){i-=r,r=-r;break}}}function Fr(n,t,e){let r=new br;e.forEach(function(l){r.put(l.mode.bit,4),r.put(l.getLength(),Nr.getCharCountIndicator(l.mode,n)),l.write(r)});let i=Le.getSymbolTotalCodewords(n),o=tt.getTotalCodewordsCount(n,t),s=(i-o)*8;for(r.getLengthInBits()+4<=s&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);let a=(s-r.getLengthInBits())/8;for(let l=0;l<a;l++)r.put(l%2?17:236,8);return kr(r,n,t)}function kr(n,t,e){let r=Le.getSymbolTotalCodewords(t),i=tt.getTotalCodewordsCount(t,e),o=r-i,s=tt.getBlocksCount(t,e),a=r%s,l=s-a,u=Math.floor(r/s),c=Math.floor(o/s),_=c+1,m=u-c,v=new Mr(m),h=0,E=new Array(s),at=new Array(s),qe=0,Kn=new Uint8Array(n.buffer);for(let Y=0;Y<s;Y++){let Fe=Y<l?c:_;E[Y]=Kn.slice(h,h+Fe),at[Y]=v.encode(E[Y]),h+=Fe,qe=Math.max(qe,Fe)}let De=new Uint8Array(r),lt=0,N,R;for(N=0;N<qe;N++)for(R=0;R<s;R++)N<E[R].length&&(De[lt++]=E[R][N]);for(N=0;N<m;N++)for(R=0;R<s;R++)De[lt++]=at[R][N];return De}function Ur(n,t,e,r){let i;if(Array.isArray(n))i=Ze.fromArray(n);else if(typeof n=="string"){let u=t;if(!u){let c=Ze.rawSplit(n);u=Re.getBestVersionForData(c,e)}i=Ze.fromString(n,u||40)}else throw new Error("Invalid data");let o=Re.getBestVersionForData(i,e);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=o;else if(t<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);let s=Fr(t,e,i),a=Le.getSymbolSize(t),l=new Tr(a);return Rr(l,t),Lr(l),Pr(l,t),Xe(l,e,0),t>=7&&qr(l,t),Dr(l,s),isNaN(r)&&(r=et.getBestMask(l,Xe.bind(null,l,e))),et.applyMask(r,l),Xe(l,e,r),{modules:l,version:t,errorCorrectionLevel:e,maskPattern:r,segments:i}}xn.create=function(t,e){if(typeof t>"u"||t==="")throw new Error("No input text");let r=$e.M,i,o;return typeof e<"u"&&(r=$e.from(e.errorCorrectionLevel,$e.M),i=Re.from(e.version),o=et.from(e.maskPattern),e.toSJISFunc&&Le.setToSJISFunction(e.toSJISFunc)),Ur(t,i,r,o)}});var nt=d(K=>{"use strict";function Mn(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let t=n.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+n);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),t.length===6&&t.push("F","F");let e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}K.getOptions=function(t){t||(t={}),t.color||(t.color={});let e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,i=t.scale||4;return{width:r,scale:r?4:i,margin:e,color:{dark:Mn(t.color.dark||"#000000ff"),light:Mn(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}};K.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale};K.getImageWidth=function(t,e){let r=K.getScale(t,e);return Math.floor((t+e.margin*2)*r)};K.qrToImageData=function(t,e,r){let i=e.modules.size,o=e.modules.data,s=K.getScale(i,r),a=Math.floor((i+r.margin*2)*s),l=r.margin*s,u=[r.color.light,r.color.dark];for(let c=0;c<a;c++)for(let _=0;_<a;_++){let m=(c*a+_)*4,v=r.color.light;if(c>=l&&_>=l&&c<a-l&&_<a-l){let h=Math.floor((c-l)/s),E=Math.floor((_-l)/s);v=u[o[h*i+E]?1:0]}t[m++]=v.r,t[m++]=v.g,t[m++]=v.b,t[m]=v.a}}});var Bn=d(Pe=>{"use strict";var rt=nt();function jr(n,t,e){n.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=e,t.width=e,t.style.height=e+"px",t.style.width=e+"px"}function Vr(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}Pe.render=function(t,e,r){let i=r,o=e;typeof i>"u"&&(!e||!e.getContext)&&(i=e,e=void 0),e||(o=Vr()),i=rt.getOptions(i);let s=rt.getImageWidth(t.modules.size,i),a=o.getContext("2d"),l=a.createImageData(s,s);return rt.qrToImageData(l.data,t,i),jr(a,o,s),a.putImageData(l,0,0),o};Pe.renderToDataURL=function(t,e,r){let i=r;typeof i>"u"&&(!e||!e.getContext)&&(i=e,e=void 0),i||(i={});let o=Pe.render(t,e,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}});var Ln=d(Rn=>{"use strict";var zr=nt();function Nn(n,t){let e=n.a/255,r=t+'="'+n.hex+'"';return e<1?r+" "+t+'-opacity="'+e.toFixed(2).slice(1)+'"':r}function it(n,t,e){let r=n+t;return typeof e<"u"&&(r+=" "+e),r}function Hr(n,t,e){let r="",i=0,o=!1,s=0;for(let a=0;a<n.length;a++){let l=Math.floor(a%t),u=Math.floor(a/t);!l&&!o&&(o=!0),n[a]?(s++,a>0&&l>0&&n[a-1]||(r+=o?it("M",l+e,.5+u+e):it("m",i,0),i=0,o=!1),l+1<t&&n[a+1]||(r+=it("h",s),s=0)):i++}return r}Rn.render=function(t,e,r){let i=zr.getOptions(e),o=t.modules.size,s=t.modules.data,a=o+i.margin*2,l=i.color.light.a?"<path "+Nn(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",u="<path "+Nn(i.color.dark,"stroke")+' d="'+Hr(s,o,i.margin)+'"/>',c='viewBox="0 0 '+a+" "+a+'"',m='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+c+' shape-rendering="crispEdges">'+l+u+`</svg>
`;return typeof r=="function"&&r(null,m),m}});var qn=d(he=>{"use strict";var Or=Pt(),ot=An(),Pn=Bn(),Jr=Ln();function st(n,t,e,r,i){let o=[].slice.call(arguments,1),s=o.length,a=typeof o[s-1]=="function";if(!a&&!Or())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(i=e,e=t,t=r=void 0):s===3&&(t.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=e,e=t,t=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(e=t,t=r=void 0):s===2&&!t.getContext&&(r=e,e=t,t=void 0),new Promise(function(l,u){try{let c=ot.create(e,r);l(n(c,t,r))}catch(c){u(c)}})}try{let l=ot.create(e,r);i(null,n(l,t,r))}catch(l){i(l)}}he.create=ot.create;he.toCanvas=st.bind(null,Pn.render);he.toDataURL=st.bind(null,Pn.renderToDataURL);he.toString=st.bind(null,function(n,t,e){return Jr.render(n,e)})});var Bt=(()=>{class n{constructor(e,r){this._http=e,this._core=r,this.ip="",this.currency="$",this.languages=ne.languages?ne.languages:[{code:"en",name:"English",origin:"English"}],this._http.get("/api/user/config",i=>{i.currency&&(this.currency=i.currency,this._core.emit("currency",this.currency)),i.ip&&(this.ip=i.ip,this._core.emit("ip",this.ip)),i.languages&&(this.languages=i.languages,this._core.emit("languages",this.languages))})}static{this.\u0275fac=function(r){return new(r||n)(x(B),x(ye))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function $n(n,t){if(n&1&&(C(0,"div")(1,"h3"),y(2,"Set domain settings"),w(),C(3,"table")(4,"thead")(5,"td"),y(6,"Type"),w(),C(7,"td"),y(8,"Host"),w(),C(9,"td"),y(10,"Value"),w()(),C(11,"tr")(12,"td"),y(13,"A Record"),w(),C(14,"td"),y(15,"*"),w(),C(16,"td"),y(17),w()(),C(18,"tr")(19,"td"),y(20,"A Record"),w(),C(21,"td"),y(22,"@"),w(),C(23,"td"),y(24),w()()()()),n&2){let e=M();b(17),z(e.config.ip),b(7),z(e.config.ip)}}var Rt=(()=>{class n{constructor(e,r,i){this.config=e,this._alert=r,this._http=i,this.ip=ne?.storeIp||""}update(){this._http.post("/api/store/domain",{_id:this.store._id,domain:this.domain},e=>{e.updated&&(this.store.domain=e.updated),e.text?this._alert.show({text:e.text}):this._alert.show({text:"Process failed"})})}static{this.\u0275fac=function(r){return new(r||n)(p(Bt),p(Et),p(B))}}static{this.\u0275cmp=A({type:n,selectors:[["app-store-domain"]],decls:8,vars:3,consts:[[4,"ngIf"],["label","Custom domain","placeholder","fill your domain",3,"wChange"],[3,"wClick","disabled"]],template:function(r,i){r&1&&(C(0,"h1"),y(1),w(),q(2,$n,25,2,"div",0),C(3,"p"),y(4,"You can fill your own domain or write subdomain to our domain without any dots"),w(),C(5,"winput",1),L("wChange",function(s){return i.domain=s}),w(),C(6,"wbutton",2),L("wClick",function(){return i.update()}),y(7,"Update"),w()),r&2&&(b(),te("Change domain: ",i.store.domain||"",""),b(),S("ngIf",i.config.ip),b(4),S("disabled",!i.domain))},dependencies:[we,Ee,Se]})}}return n})();var kn=Yn(qn(),1);function Kr(n,t){if(n&1&&pe(0,"canvas",1),n&2){let e=M();mt(e.styleClass),S("qrCode",e.value)("qrCodeErrorCorrectionLevel",e.errorCorrectionLevel)("qrCodeCenterImageSrc",e.centerImageSrc)("qrCodeCenterImageWidth",e.centerImageSize)("qrCodeCenterImageHeight",e.centerImageSize)("qrCodeMargin",e.margin)("width",e.size)("height",e.size)("ngStyle",e.style)("darkColor",e.darkColor)("lightColor",e.lightColor)}}var Dn=/^#(?:[0-9a-fA-F]{3,4}){1,2}$/,Yr=(()=>{class n{static{this.DEFAULT_ERROR_CORRECTION_LEVEL="M"}static{this.DEFAULT_CENTER_IMAGE_SIZE=40}constructor(e){this.viewContainerRef=e,this.errorCorrectionLevel=n.DEFAULT_ERROR_CORRECTION_LEVEL,this.darkColor="#000000FF",this.lightColor="#FFFFFFFF",this.margin=16}ngOnChanges(){return ct(this,null,function*(){if(!this.value)return;this.version&&this.version>40?(console.warn("[qrCode] max version is 40, clamping"),this.version=40):this.version&&this.version<1?(console.warn("[qrCode] min version is 1, clamping"),this.version=1):this.version!==void 0&&isNaN(this.version)&&(console.warn("[qrCode] version should be set to a number, defaulting to auto"),this.version=void 0);let e=this.viewContainerRef.element.nativeElement;if(!e)return;let r=e.getContext("2d");r&&r.clearRect(0,0,r.canvas.width,r.canvas.height);let i=this.errorCorrectionLevel??n.DEFAULT_ERROR_CORRECTION_LEVEL,o=Dn.test(this.darkColor)?this.darkColor:void 0,s=Dn.test(this.lightColor)?this.lightColor:void 0;Ct()&&(!o&&this.darkColor&&console.error("[ng-qrcode] darkColor set to invalid value, must be RGBA hex color string, eg: #3050A1FF"),!s&&this.lightColor&&console.error("[ng-qrcode] lightColor set to invalid value, must be RGBA hex color string, eg: #3050A130")),yield kn.default.toCanvas(e,this.value,{version:this.version,errorCorrectionLevel:i,width:this.width,margin:this.margin,color:{dark:o,light:s}});let a=this.centerImageSrc,l=Fn(this.centerImageWidth,n.DEFAULT_CENTER_IMAGE_SIZE),u=Fn(this.centerImageHeight,n.DEFAULT_CENTER_IMAGE_SIZE);if(a&&r){this.centerImage||(this.centerImage=new Image(l,u));let c=this.centerImage;a!==this.centerImage.src&&(c.src=a),l!==this.centerImage.width&&(c.width=l),u!==this.centerImage.height&&(c.height=u);let _=()=>{r.drawImage(c,e.width/2-l/2,e.height/2-u/2,l,u)};c.onload=_,c.complete&&_()}})}static{this.\u0275fac=function(r){return new(r||n)(p(dt))}}static{this.\u0275dir=ut({type:n,selectors:[["canvas","qrCode",""]],inputs:{value:[0,"qrCode","value"],version:[0,"qrCodeVersion","version"],errorCorrectionLevel:[0,"qrCodeErrorCorrectionLevel","errorCorrectionLevel"],width:"width",height:"height",darkColor:"darkColor",lightColor:"lightColor",centerImageSrc:[0,"qrCodeCenterImageSrc","centerImageSrc"],centerImageWidth:[0,"qrCodeCenterImageWidth","centerImageWidth"],centerImageHeight:[0,"qrCodeCenterImageHeight","centerImageHeight"],margin:[0,"qrCodeMargin","margin"]},features:[ht]})}}return n})();function Fn(n,t){return n===void 0||n===""?t:typeof n=="string"?parseInt(n,10):n}var Un=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=A({type:n,selectors:[["qr-code"]],inputs:{value:"value",size:"size",style:"style",styleClass:"styleClass",darkColor:"darkColor",lightColor:"lightColor",errorCorrectionLevel:"errorCorrectionLevel",centerImageSrc:"centerImageSrc",centerImageSize:"centerImageSize",margin:"margin"},decls:1,vars:1,consts:[[3,"qrCode","qrCodeErrorCorrectionLevel","qrCodeCenterImageSrc","qrCodeCenterImageWidth","qrCodeCenterImageHeight","qrCodeMargin","width","height","class","ngStyle","darkColor","lightColor"],[3,"qrCode","qrCodeErrorCorrectionLevel","qrCodeCenterImageSrc","qrCodeCenterImageWidth","qrCodeCenterImageHeight","qrCodeMargin","width","height","ngStyle","darkColor","lightColor"]],template:function(r,i){r&1&&q(0,Kr,1,13,"canvas",0),r&2&&gt(i.value?0:-1)},dependencies:[wt,Yr],encapsulation:2})}}return n})(),jn=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=de({type:n})}static{this.\u0275inj=fe({imports:[yt]})}}return n})();var Vn=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=A({type:n,selectors:[["app-store-qrcode"]],decls:1,vars:2,consts:[["size","1024","darkColor","#000","lightColor","#fff","errorCorrectionLevel","M","centerImageSize","200",1,"cutCanvas",3,"value","margin"]],template:function(r,i){r&1&&pe(0,"qr-code",0),r&2&&S("value","https://"+i.store.domain)("margin",4)},dependencies:[Un]})}}return n})();function $r(n,t){if(n&1){let e=Ce();C(0,"wbutton",1),L("click",function(){me(e);let i=M();return ge(i.changeAgent())}),y(1,"Change agent"),w()}}var zn=(()=>{class n{get title(){return"Change ownership"+(this.us.role("admin")?" or agent":"")}constructor(e,r,i,o){this._translate=e,this._alert=r,this._http=i,this.us=o}changeOwnership(){this.userId?this._alert.question({unique:"storeownership",text:this._translate.translate("Store.Are you sure you want to transfer ownership?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._http.post("/api/store/change/ownership",{storeId:this.store._id,userId:this.userId},e=>{e?this._alert.show({text:this._translate.translate("Store.Ownership changed")}):this._alert.show({text:this._translate.translate("Store.There been a server error")})})}}]}):this._alert.error({text:this._translate.translate("Store.Please select user to transfer ownership")})}changeAgent(){this.userId?this._alert.question({unique:"storeagent",text:this._translate.translate("Store.Are you sure you want to transfer agent?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._http.post("/api/store/change/agent",{storeId:this.store._id,userId:this.userId},e=>{e?this._alert.show({text:this._translate.translate("Store.Agent changed")}):this._alert.show({text:this._translate.translate("Store.There been a server error")})})}}]}):this._alert.error({text:this._translate.translate("Store.Please select user to transfer agent")})}static{this.\u0275fac=function(r){return new(r||n)(p(Ie),p(D),p(B),p(_e))}}static{this.\u0275cmp=A({type:n,selectors:[["app-store-transfer"]],decls:6,vars:4,consts:[["placeholder","Select new user","searchableBy","name email","name","email",3,"modelChange","searchable","items"],[3,"click"],[3,"click",4,"ngIf"]],template:function(r,i){r&1&&(C(0,"h1"),y(1),w(),C(2,"wselect",0),L("modelChange",function(s){return i.userId=s}),w(),C(3,"wbutton",1),L("click",function(){return i.changeOwnership()}),y(4,"Change ownership"),w(),q(5,$r,2,0,"wbutton",2)),r&2&&(b(),z(i.title),b(),S("searchable",!0)("items",i.us.users),b(3),S("ngIf",i.us.role("admin")))},dependencies:[vt,we,Ee]})}}return n})();var Hn=(()=>{class n{plan(e){return this._planfeatures.plan?this._planfeatures.plan[e]||[]:[]}new(){return{}}constructor(e,r){this.mongo=e,this.alert=r,this.planfeatures=[],this._planfeatures={},this.planfeatures=e.get("userfeature",{replace:{inPlan:e.beObj,inDone:e.beObj},sort:e.sortAscNumber("order")},(i,o)=>{this._planfeatures=o})}create(e=this.new(),r=o=>{},i="planfeature has been created."){e._id?this.save(e):this.mongo.create("userfeature",e,o=>{r(o),this.alert.show({text:i})})}doc(e){return this._planfeatures[e]||(this._planfeatures[e]=this.mongo.fetch("userfeature",{query:{_id:e}})),this._planfeatures[e]}update(e,r=o=>{},i="planfeature has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,r,i)})}save(e,r=o=>{},i="planfeature has been updated."){this.mongo.update("userfeature",e,()=>{i&&this.alert.show({text:i,unique:e})})}delete(e,r=o=>{},i="planfeature has been deleted."){this.mongo.delete("userfeature",e,()=>{i&&this.alert.show({text:i})})}static{this.\u0275fac=function(r){return new(r||n)(x(Q),x(D))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var On=(()=>{class n{new(){return{}}constructor(e,r,i){this.mongo=e,this.alert=r,this._http=i,this.themeJsons=[],this.byModule={},this.themes=[],this._themes={},this._http.get("/api/theme/jsons",o=>o.forEach(s=>this.themeJsons.push(s))),this.themes=e.get("theme",{groups:"module"},(o,s)=>{this.byModule=s.module,this._themes=s})}create(e=this.new(),r=o=>{},i="theme has been created."){e._id?this.save(e):this.mongo.create("theme",e,o=>{r(o),this.alert.show({text:i})})}doc(e){return this._themes[e]||(this._themes[e]=this.mongo.fetch("theme",{query:{_id:e}})),this._themes[e]}update(e,r=o=>{},i="theme has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,r,i)})}save(e,r=o=>{},i="theme has been updated."){this.mongo.update("theme",e,()=>{i&&this.alert.show({text:i,unique:e})})}delete(e,r=o=>{},i="theme has been deleted."){this.mongo.delete("theme",e,()=>{i&&this.alert.show({text:i})})}static{this.\u0275fac=function(r){return new(r||n)(x(Q),x(D),x(B))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ei(n,t){if(n&1){let e=Ce();C(0,"winput",5),L("wChange",function(i){let o=me(e).$implicit,s=M();return o.enabled=i,ge(s.update(o))}),w()}if(n&2){let e=t.$implicit;S("value",e.enabled)}}function ti(n,t){if(n&1&&y(0),n&2){let e=t.$implicit,r=M();te(" ",r.us.doc(e.author).email," ")}}function ni(n,t){if(n&1&&y(0),n&2){let e=t.$implicit,r=M();te(" ",e.agent?r.us.doc(e.agent).email:""," ")}}function ri(n,t){if(n&1&&(C(0,"a",6),y(1),w()),n&2){let e=t.$implicit;pt("href","https://",e.domain,"",ft),b(),z(e.domain)}}var Jn=(()=>{class n{setVariables(e={}){if(e.theme&&this.fetchedTheme!==e.theme){this.variables.splice(0,this.variables.length),this.features.splice(0,this.features.length),this.fetchedTheme=e.theme,this._http.get(`/api/theme/template/variables/${e.theme}`,i=>{let o=!0;e.variables=e.variables||{};for(let s in i.variables){let a=i.variablesInfo[s]?.name||"Text";this.variables.push({focused:!!(o&&a==="Text"),key:s,root:!0,name:a,fields:[{name:"Placeholder",value:"fill "+s},{name:"Label",value:s}]}),a==="Text"&&(o=!1),e.variables[s]=typeof e.variables[s]>"u"?i.variables[s]:e.variables[s]}}),this.features.splice(0,this.features.length);let r=this._ts.doc(e.theme);for(let i of r.features||[])this.features.push(this._ufs.doc(i))}}get rows(){return this._ss.stores}update(e){this._ss.update(e)}constructor(e,r,i,o,s,a,l,u,c,_,m,v){this._translate=e,this._ufs=r,this._alert=i,this._mongo=o,this._modal=s,this._http=a,this._form=l,this._core=u,this._ts=c,this._ss=_,this._tss=m,this.us=v,this.title=this._ss.config.pageTitle,this.columns=["enabled","name","domain"],this.features=[],this.variables=[],this.formVariables=this._form.getForm("variables",{formId:"variables",title:"Variables",components:this.variables}),this.config={create:()=>{this._form.modal(this.form,{label:this._translate.translate("Common.Create"),click:(h,E)=>{this._ss.create(h),E()}},this._ss.config.defaultIndexPage?{indexPage:this._ss.config.defaultIndexPage}:{}).then(this._ss.create.bind(this))},update:h=>{this._form.modal(this.form,[],h).then(E=>{E&&(this._core.copy(E,h),this._ss.save(h)),this.setVariables(h)})},delete:h=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this store?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._ss.delete(h)}}]})},buttons:[{icon:"text_fields",click:h=>{h.variables=h.variables||{},this._form.modal(this.formVariables,[],h.variables).then(E=>{this._core.copy(E,h.variables),this._ss.save(h)})}},{icon:"cloud_download",click:h=>{this._modal.show({component:Rt,store:h})}},{icon:"qr_code",click:h=>{this._modal.show({component:Vn,store:h})}},this.us.role("agent")||this.us.role("admin")?{icon:"people",click:h=>{this._modal.show({component:zn,store:h})}}:null]},this.us.role("admin")?(this.columns.push("author"),this.columns.push("agent")):this.us.role("agent")&&(this.columns.push("location"),this.columns.push("author")),this._mongo.on("store theme",()=>{for(let h of this.rows)this.setVariables(h)}),this._mongo.on("theme tag",()=>{let h=this._ss.config.pages.map(E=>({_id:E.page,name:E.page}));this.form=this._form.getForm("store",{formId:"store",title:this._ss.config.docTitle,components:[{name:"Photo",key:"favicon",fields:[{name:"Label",value:"Favicon"},{name:"Width",value:64},{name:"Height",value:64}]},{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Header picture"}]},{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill your name"},{name:"Label",value:"Name"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill your description"},{name:"Label",value:"Description"}]},{name:"Select",key:"features",fields:[{name:"Placeholder",value:"Select features"},{name:"Items",value:this.features},{name:"Multiple",value:!0}]},{name:"Select",key:"theme",fields:[{name:"Placeholder",value:"Select theme"},{name:"Items",value:this._ts.byModule.store}]},{name:"Text",key:"currency",fields:[{name:"Placeholder",value:"fill custom currency"},{name:"Label",value:"Currency"}]}]})})}static{this.\u0275fac=function(r){return new(r||n)(p(Ie),p(Hn),p(D),p(Q),p(It),p(B),p(St),p(ye),p(On),p(At),p(Mt),p(_e))}}static{this.\u0275cmp=A({type:n,selectors:[["ng-component"]],decls:5,vars:4,consts:[[3,"columns","config","title","rows"],["cell","enabled"],["cell","author"],["cell","agent"],["cell","domain"],["type","checkbox",3,"wChange","value"],["target","_blank",3,"href"]],template:function(r,i){r&1&&(C(0,"wtable",0),q(1,ei,1,1,"ng-template",1)(2,ti,1,1,"ng-template",2)(3,ni,1,1,"ng-template",3)(4,ri,2,3,"ng-template",4),w()),r&2&&S("columns",i.columns)("config",i.config)("title",i.title)("rows",i.rows)},dependencies:[Se,Tt,bt]})}}return n})();var ii=[{path:"",component:Jn}],go=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=de({type:n})}static{this.\u0275inj=fe({imports:[_t.forChild(ii),jn,xt]})}}return n})();export{go as StoresModule};
