import{a as C}from"./chunk-LVMI42ZP.js";import{a as U}from"./chunk-DZVV4JSR.js";import{a as Y}from"./chunk-YE5FV3IB.js";import{g as J}from"./chunk-C3S2QHG2.js";import"./chunk-TGKOXAGH.js";import{$a as L,C as g,D as n,Ea as P,Ga as D,H as b,J as d,Ka as E,O as a,P as l,Ra as F,T as y,U as h,V as _,Wa as N,Ya as V,_a as A,ca as u,da as k,db as B,eb as G,gb as v,lb as R,m as x,mb as q,nb as O,o as f,p as j,pb as $,qb as H,t as T,u as S,ua as M}from"./chunk-2AZ5U4IF.js";var K=(()=>{let t=class t{constructor(e){this._ts=e,this.chatGPT=`Here is a schema for a MongoDB collection:
	mongoose.Schema({
		name: String,
		description: String,
	})
	Please review this schema. I will provide you with specific details about the documents I need you to generate in a follow-up message. For now, do not create or suggest any documents; just acknowledge the schema and wait for my next instructions.`,this.entities=""}create(){let e=JSON.parse(this.entities),i=e.length;for(let s of e)this.store&&(s.stores=[this.store]),this.parent&&(s.parent=[this.parent]),this._ts.create(s,()=>{--i===0&&this.setTags()})}};t.\u0275fac=function(i){return new(i||t)(n(C))},t.\u0275cmp=f({type:t,selectors:[["app-tags-create"]],decls:9,vars:1,consts:[["placeholder","Provide array of Tags",3,"wChange"],[3,"click"]],template:function(i,s){i&1&&(a(0,"h1"),u(1,"Create Tags"),l(),a(2,"winput",0),h("wChange",function(w){return s.entities=w}),l(),a(3,"wbutton",1),h("click",function(){return s.create(),s.close()}),u(4,"Create"),l(),a(5,"div"),u(6,"Drop next text to chatGPT to inform him what data he should create. After that you can inform him what you need to be created"),l(),a(7,"pre"),u(8),l()),i&2&&(g(8),k(s.chatGPT))},dependencies:[G,v]});let o=t;return o})();function re(o,t){if(o&1){let c=y();a(0,"wselect",3),h("modelChange",function(i){T(c);let s=_();return S(s.setStore(i))}),l()}if(o&2){let c=_();d("clearable",!0)("items",c.stores)("select",c.store)}}function ae(o,t){if(o&1){let c=y();a(0,"winput",4),h("wChange",function(i){let s=T(c).$implicit,p=_();return s.enabled=i,S(p.update(s))}),l()}if(o&2){let c=t.$implicit;d("value",c.enabled)}}var I=(()=>{let t=class t{childrenUrl(e){let i=this._router.url.split("/");return this.parent&&i.pop(),i.push(e._id),i.join("/")}sort(){for(let e=0;e<this.tags.length;e++)this.tags[e].order!==e&&(this.tags[e].order=e,this._ts.save(this.tags[e],()=>{},""))}setTags(){this.tags.splice(0,this.tags.length);for(let e of this._ts.tags)e.stores=e.stores||[],!this.store&&!this.parent?e.parent||this.tags.push(e):this.store&&this.parent?e.parent===this.parent&&e.stores.includes(this.store)&&this.tags.push(e):this.parent?e.parent===this.parent&&this.tags.push(e):e.stores.includes(this.store)&&!e.parent&&this.tags.push(e)}update(e){this._ts.update(e)}get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setTags()}constructor(e,i,s,p,w,Q,W,X,Z,ee,te,ie){this._translate=e,this.route=i,this._alert=s,this._modal=p,this._mongo=w,this._store=Q,this._form=W,this._core=X,this._ss=Z,this._us=ee,this._ts=te,this._router=ie,this.parent="",this.columns=["enabled","name","url"],this.form=this._form.getForm("tag",{components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill your name"},{name:"Label",value:"Name"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill your description"},{name:"Label",value:"Description"}]},{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Image"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill your stores"},{name:"Label",value:"Stores"},{name:"Multiple",value:!0},{name:"Items",value:this.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(r,m)=>{this.parent&&(r.parent=this.parent),this._ts.create(r,()=>{this.setTags(),this.sort()}),m()}},this.store?{stores:[this.store]}:{})},update:r=>{this._form.modal(this.form,[],r).then(m=>{this._core.copy(m,r),this._ts.save(r)})},delete:r=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this tag?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._ts.delete(r,this.setTags.bind(this))}}]})},buttons:[{icon:"label_important",hrefFunc:this.childrenUrl.bind(this)},{icon:"arrow_upward",click:r=>{let m=this.tags.findIndex(se=>se._id===r._id);[this.tags[m],this.tags[m-1]]=[this.tags[m-1],this.tags[m]],this.sort()}},{icon:"cloud_download",click:r=>{this._form.modalUnique("tag","url",r)}}],headerButtons:[this._us.role("admin")||this._us.role("agent")?{icon:"add_circle",click:()=>{this._modal.show({setTags:this.setTags.bind(this),component:K,parent:this.parent,store:this.store})}}:null]},this.tags=[],this._store.get("store",this.setStore.bind(this)),this._mongo.on("tag",this.setTags.bind(this))}ngOnInit(){this.route.params.subscribe(e=>{e.parent&&(this.parent=e.parent,this.setTags())})}};t.\u0275fac=function(i){return new(i||t)(n(B),n(P),n(A),n(L),n(V),n(N),n(R),n(F),n(Y),n(U),n(C),n(D))},t.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:3,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Product Tags",3,"columns","config","rows"],["cell","enabled"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"],["type","checkbox",3,"wChange","value"]],template:function(i,s){i&1&&(b(0,re,1,3,"wselect",0),a(1,"wtable",1),b(2,ae,1,1,"ng-template",2),l()),i&2&&(d("ngIf",s.stores.length),g(),d("columns",s.columns)("config",s.config)("rows",s.tags))},dependencies:[q,M,v,H,$]});let o=t;return o})();var le=[{path:"",component:I},{path:":parent",component:I}],Me=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=j({type:t}),t.\u0275inj=x({imports:[E.forChild(le),O,J]});let o=t;return o})();export{Me as TagsModule};
