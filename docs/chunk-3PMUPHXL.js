import{a as $}from"./chunk-DZVV4JSR.js";import{a as R}from"./chunk-YE5FV3IB.js";import{g as O}from"./chunk-C3S2QHG2.js";import"./chunk-TGKOXAGH.js";import{$a as A,C as v,D as r,H as j,J as h,Ka as F,O as c,P as l,Ra as L,T as g,U as p,V as d,Wa as N,Ya as w,_a as b,ca as u,da as V,db as q,eb as G,gb as y,l as E,lb as B,m as M,mb as U,n as I,o as f,p as P,pb as H,qb as J,t as _,u as C,ua as D}from"./chunk-2AZ5U4IF.js";var S=(()=>{let t=class t{new(){return{}}constructor(e,i){this.mongo=e,this.alert=i,this.contents=[],this._contents={},this.contents=e.get("content",{},(n,s)=>{this._contents=s})}create(e=this.new(),i=s=>{},n="content has been created."){e._id?this.save(e):this.mongo.create("content",e,s=>{i(s),this.alert.show({text:n})})}doc(e){return this._contents[e]||(this._contents[e]=this.mongo.fetch("content",{query:{_id:e}})),this._contents[e]}update(e,i=s=>{},n="content has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,i,n)})}save(e,i=s=>{},n="content has been updated."){this.mongo.update("content",e,()=>{n&&this.alert.show({text:n,unique:e})})}delete(e,i=s=>{},n="content has been deleted."){this.mongo.delete("content",e,()=>{n&&this.alert.show({text:n})})}};t.\u0275fac=function(i){return new(i||t)(I(w),I(b))},t.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var Y=(()=>{let t=class t{constructor(e){this._ss=e,this.chatGPT="[{name: 'Entity Name'}]",this.entities=""}create(){let e=JSON.parse(this.entities);for(let i of e)i.stores=this.store?[this.store]:[],this._ss.create(i)}};t.\u0275fac=function(i){return new(i||t)(r(S))},t.\u0275cmp=f({type:t,selectors:[["app-contents-create"]],decls:9,vars:1,consts:[["placeholder","Provide array of Content",3,"wChange"],[3,"click"]],template:function(i,n){i&1&&(c(0,"h1"),u(1,"Create Content"),l(),c(2,"winput",0),p("wChange",function(x){return n.entities=x}),l(),c(3,"wbutton",1),p("click",function(){return n.create(),n.close()}),u(4,"Create"),l(),c(5,"div"),u(6,"Drop next text to chatGPT to inform him what data he should create. After that you can inform him what you need to be created"),l(),c(7,"pre"),u(8),l()),i&2&&(v(8),V(n.chatGPT))},dependencies:[G,y]});let o=t;return o})();function ne(o,t){if(o&1){let a=g();c(0,"wselect",4),p("modelChange",function(i){_(a);let n=d();return C(n.setStore(i))}),l()}if(o&2){let a=d();h("clearable",!0)("items",a.stores)("select",a.store)}}function oe(o,t){if(o&1){let a=g();c(0,"winput",5),p("wChange",function(i){let n=_(a).$implicit,s=d();return n.enabled=i,C(s.update(n))}),l()}if(o&2){let a=t.$implicit;h("value",a.enabled)}}function se(o,t){if(o&1){let a=g();c(0,"winput",5),p("wChange",function(i){let n=_(a).$implicit,s=d();return n.top=i,C(s.update(n))}),l()}if(o&2){let a=t.$implicit;h("value",a.top)}}var z=(()=>{let t=class t{setContents(){this.contents.splice(0,this.contents.length);for(let e of this._cs.contents)e.stores=e.stores||[],this.store?e.stores.includes(this.store)&&this.contents.push(e):this.contents.push(e)}update(e){this._cs.update(e)}get stores(){return this._ss.stores}setStore(e){this.store=e,this._store.set("store",e),this.setContents()}constructor(e,i,n,s,x,K,Q,X,Z,ee){this._cs=e,this._translate=i,this._alert=n,this._form=s,this._core=x,this._modal=K,this._mongo=Q,this._us=X,this._store=Z,this._ss=ee,this.columns=["enabled","top","name","description"],this.form=this._form.getForm("contents",{formId:"contents",title:"Contents",components:[{name:"Photo",key:"thumb",fields:[{name:"Label",value:"Header picture"}]},{name:"Text",key:"url",focused:!0,fields:[{name:"Placeholder",value:"fill url"},{name:"Label",value:"Url"}]},{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill description"},{name:"Label",value:"Description"}]},{name:"Text",key:"content",fields:[{name:"Placeholder",value:"fill content"},{name:"Label",value:"Content"}]},{name:"Select",key:"stores",fields:[{name:"Placeholder",value:"fill product tag"},{name:"Label",value:"Tag"},{name:"Multiple",value:!0},{name:"Items",value:this._ss.stores}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(m,T)=>{this.store&&(m.stores=[this.store]),this._cs.create(m,this.setContents.bind(this)),T()}},this.store?{stores:[this.store]}:{})},update:m=>{this._form.modal(this.form,[],m).then(T=>{this._core.copy(T,m),this._cs.save(m)})},delete:m=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this cservice?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._cs.delete(m)}}]})},headerButtons:[this._us.role("admin")||this._us.role("agent")?{icon:"add_circle",click:()=>{this._modal.show({component:Y,store:this.store})}}:null]},this.contents=[],this._store.get("store",this.setStore.bind(this)),this._mongo.on("content",this.setContents.bind(this))}};t.\u0275fac=function(i){return new(i||t)(r(S),r(q),r(b),r(B),r(L),r(A),r(w),r($),r(N),r(R))},t.\u0275cmp=f({type:t,selectors:[["ng-component"]],decls:4,vars:4,consts:[["placeholder","Select store","style","padding-bottom: 10px;",3,"clearable","items","select","modelChange",4,"ngIf"],["title","Contents",3,"columns","config","rows"],["cell","enabled"],["cell","top"],["placeholder","Select store",2,"padding-bottom","10px",3,"modelChange","clearable","items","select"],["type","checkbox",3,"wChange","value"]],template:function(i,n){i&1&&(j(0,ne,1,3,"wselect",0),c(1,"wtable",1),j(2,oe,1,1,"ng-template",2)(3,se,1,1,"ng-template",3),l()),i&2&&(h("ngIf",n.stores.length),v(),h("columns",n.columns)("config",n.config)("rows",n.contents))},dependencies:[U,D,y,J,H]});let o=t;return o})();var re=[{path:"",component:z}],xe=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=P({type:t}),t.\u0275inj=M({imports:[F.forChild(re),O]});let o=t;return o})();export{xe as ContentsModule};
